<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
    <script src="http://learning-fuze.github.io/memory_match/v0.1/script.js"></script>
    <script>
        var count = 1;
        var clickCount = 0;
        var first_card_clicked = null;
        var second_card_clicked = null;
        var match_counter = 0;
        var games_played = 0;
        var canIflip = true;


        $(document).ready(function(){
            $("#backgroundMusic").get(0).play();
            //**********************************************************************************************************
            function randomizeBackground(){
                var imagesArray = ['images/artorias.jpg','images/brador.jpg','images/eileen.jpg','images/iosefka.jpg','images/lady_maria.jpg','images/logan.jpg','images/ornstein.jpg','images/oscar.jpg','images/quelaag.jpg','images/artorias.jpg','images/brador.jpg','images/eileen.jpg','images/iosefka.jpg','images/lady_maria.jpg','images/logan.jpg','images/ornstein.jpg','images/oscar.jpg','images/quelaag.jpg'];
                var randomArray =[];
                for(var i=0;i<18;i++){
                    var randomNumber = Math.floor(Math.random()*imagesArray.length);
                    randomArray.push(imagesArray[randomNumber]);
                    imagesArray.splice(randomNumber, 1);
                }
                return randomArray;
            }
            var backgroundArray = randomizeBackground();
            //**********************************************************************************************************
            function applyBackground(){
                $('#card1').css('background-image',"url("+backgroundArray[0]+")");
                $('#card2').css('background-image',"url("+backgroundArray[1]+")");
                $('#card3').css('background-image',"url("+backgroundArray[2]+")");
                $('#card4').css('background-image',"url("+backgroundArray[3]+")");
                $('#card5').css('background-image',"url("+backgroundArray[4]+")");
                $('#card6').css('background-image',"url("+backgroundArray[5]+")");
                $('#card7').css('background-image',"url("+backgroundArray[6]+")");
                $('#card8').css('background-image',"url("+backgroundArray[7]+")");
                $('#card9').css('background-image',"url("+backgroundArray[8]+")");
                $('#card10').css('background-image',"url("+backgroundArray[9]+")");
                $('#card11').css('background-image',"url("+backgroundArray[10]+")");
                $('#card12').css('background-image',"url("+backgroundArray[11]+")");
                $('#card13').css('background-image',"url("+backgroundArray[12]+")");
                $('#card14').css('background-image',"url("+backgroundArray[13]+")");
                $('#card15').css('background-image',"url("+backgroundArray[14]+")");
                $('#card16').css('background-image',"url("+backgroundArray[15]+")");
                $('#card17').css('background-image',"url("+backgroundArray[16]+")");
                $('#card18').css('background-image',"url("+backgroundArray[17]+")");
            }
            //**********************************************************************************************************
            function card_clicked(){
                $('.container').on('click', function () {
                    if (canIflip === true) {
                        if (first_card_clicked === null) {
                            $(this).find('.flip').addClass('flipped');
                            first_card_clicked = $(this).find('.back').css('background-image');
                            clickCount++;
                        }
                        else {
                            if (!$(this).find('.flip').hasClass('flipped')) {
                                $(this).find('.flip').addClass("flipped");
                                second_card_clicked = $(this).find('.back').css('background-image');
                                canIflip = false;
                                checkMatch();
                            }
                        }
                        if (clickCount % 2 === 0) {
                            $('.attempt .value').text(count++);
                            $('.accuracy .value').html((((match_counter) / (clickCount / 2)) * 100).toFixed(0) + "%");
                        }
                    }
                });
            }
            //**********************************************************************************************************
            function cardDefault(){
                first_card_clicked = null;
                second_card_clicked = null;
                canIflip = true;
            }
            //**********************************************************************************************************
            function flipBack() {
                $('.flipped').filter(function () {
                    var back = $(this).find('.back');
                    var source = back.css('background-image');
                    return source === first_card_clicked || source === second_card_clicked;
                }).removeClass('flipped');
                cardDefault();
            }

            //**********************************************************************************************************
            function audioPlay(){
                switch (first_card_clicked){
                    case 'url("http://localhost:63342/lfz/memory_match/images/artorias.jpg")':
                        $('#artorias').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/brador.jpg")':
                        $('#brador').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/eileen.jpg")':
                        $('#eileen').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/iosefka.jpg")':
                        $('#iosefka').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/lady_maria.jpg")':
                        $('#lady_maria').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/logan.jpg")':
                        $('#logan').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/ornstein.jpg")':
                        $('#ornstein').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/oscar.jpg")':
                        $('#oscar').get(0).play();
                        break;
                    case 'url("http://localhost:63342/lfz/memory_match/images/quelaag.jpg")':
                        $('#quelaag').get(0).play();
                        break;
                }
            }
            //**********************************************************************************************************
            function checkMatch(){
                if(first_card_clicked === second_card_clicked && match_counter < 8 ){
                    audioPlay();
                    clickCount++;
                    match_counter++;
                    cardDefault();
                }
                else if (first_card_clicked !== second_card_clicked) {
                    clickCount++;
                    setTimeout(flipBack, 800);
                }
                else {
                    audioPlay();
                    match_counter++;
                }
            }
            //**********************************************************************************************************
            function resetGame() {
                $('#reset').click(function () {
                    $('.flipped').removeClass('flipped');
                    $('.attempt .value').html("");
                    $('.accuracy .value').html("");
                    count=1;
                    games_played++;
                    $('.games-played .value').text(games_played);
                    clickCount=0;
                    match_counter=0;
                    cardDefault();
                });
            }
            //**********************************************************************************************************
            applyBackground();
            card_clicked();
            resetGame();
        });


    </script>
</head>
<body>
    <audio id="backgroundMusic" src="sounds/01-souls-of-fire.mp3" loop="loop"></audio>
    <audio id="artorias" src="sounds/dialogue/artorias.mp3"></audio>
    <audio id="brador" src="sounds/dialogue/brador.mp3"></audio>
    <audio id="eileen" src="sounds/dialogue/eileen.mp3"></audio>
    <audio id="iosefka" src="sounds/dialogue/iosefka.mp3"></audio>
    <audio id="lady_maria" src="sounds/dialogue/lady_maria.mp3"></audio>
    <audio id="logan" src="sounds/dialogue/logan.mp3"></audio>
    <audio id="ornstein" src="sounds/dialogue/ornstein.mp3"></audio>
    <audio id="oscar" src="sounds/dialogue/oscar.mp3"></audio>
    <audio id="quelaag" src="sounds/dialogue/quelaag.mp3"></audio>
    <div id="header">
        <a href="">Settings</a>
        <a href="about.html">About</a>
        <img src="images/dark_souls_banner.jpg" id="banner">

    </div>

    <div id="row_container">
        <div id="stats">
            <div class="games-played">
                <h2 class="label">Games Played</h2>
                <div class="value"></div>
            </div>
            <div class="attempt">
                <div class="label">Attempts:</div>
                <div class="value"></div>
            </div>
            <div class="accuracy">
                <div class="label">Accuracy:</div>
                <div class="value"></div>
            </div>
            <img src="images/bonfire.jpg" id="reset">
        </div>
        <div class="row_health">
            <div id="health_container">
                <div id="health"></div>
            </div>
            <div id="stamina_container">
                <div id="stamina"></div>
            </div>
        </div>
        <div class="row">
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card1" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card2" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card3" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card4" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card5" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card6" class="face back"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card7" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card8" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card9" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card10" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card11" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card12" class="face back"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card13" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card14" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card15" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card16" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card17" class="face back"></div>
                </div>
            </div>
            <div class="container">
                <div class="flip">
                    <div class="face front"></div>
                    <div id="card18" class="face back"></div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>